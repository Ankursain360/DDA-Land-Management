function GetExcel(n,t){var i=GetSearchParam(n,t);HttpPost(`/DemandsletterReport/DemandLetterReportList`,"html",i,function(){var n=document.createElement("a");n.target="_blank";n.href="/DemandsletterReport/download";n.click()})}function GetDetails(n,t){var i=GetSearchParam(n,t),r=ValidCheck();r&&HttpPost(`/DemandsletterReport/GetDetails`,"html",i,function(n){$("#LoadReportView").html("");$("#LoadReportView").html(n)})}function GetSearchParam(n,t){var i=$("#Sortbyd").val(),u=$("#sortdesc").val();i=i?i:"Locality";var f=$("#PropertyNo option:selected").val(),e=$("#FileNo").val(),o=$("#LocalityId option:selected").val(),s=$("#FromDate").val(),h=$("#ToDate").val(),r={colname:i,orderby:u,pageSize:parseInt(t),pageNumber:parseInt(n),PropertyNo:parseInt(f),FileNo:e,Locality:parseInt(o),FromDate:s,ToDate:h};return[].push(r),r}function onPaging(n){GetDetails(parseInt(n),parseInt(currentPageSize));currentPageNumber=n}function onChangePageSize(n){GetDetails(parseInt(currentPageNumber),parseInt(n));currentPageSize=n}function callSelect2(){$("select").select2({placeholder:"Select",allowClear:!0})}function ValidCheck(){var n=!1,i=$("#FromDate").val(),t;return i==""?(n=!1,$("#FromDateMsg").show()):($("#FromDateMsg").hide(),n=!0),t=$("#ToDate").val(),t==""?(n=!1,$("#ToDateMsg").show()):(n=!0,$("#ToDateMsg").hide()),i==""||t==""?!1:!0}function GetSearchParamDownload(){return{PropertyNo:parseInt($("#PropertyNo option:selected").val()),FileNo:$("#FileNo").val(),Locality:parseInt($("#LocalityId option:selected").val()),FromDate:$("#FromDate").val(),ToDate:$("#ToDate").val()}}var currentPageNumber=1,currentPageSize=5;$(document).ready(function(){$("#btnGenerate").click(function(){var n=GetSearchParam(currentPageNumber,currentPageSize),t=ValidCheck();t&&HttpPost(`/DemandsletterReport/GetDetails`,"html",n,function(n){$("#LoadReportView").html("");$("#LoadReportView").html(n)})})});$("#btnDownload").click(function(){GetExcel(currentPageNumber,currentPageSize)});$("#btnReset").click(function(){$("#FileNo").val("");$("#txtLocality").val("");$("#PropertyNo option:selected").val("");GetDetails(currentPageNumber,currentPageSize)});$("#Sortbyd").change(function(){GetDetails(currentPageNumber,currentPageSize)});$("#ascId").click(function(){$("#descId").removeClass("active");$("#ascId").addClass("active");$("#sortdesc").val(2);GetDetails(currentPageNumber,currentPageSize)});$("#descId").click(function(){$("#ascId").removeClass("active");$("#descId").addClass("active");$("#sortdesc").val(1);GetDetails(currentPageNumber,currentPageSize)});$("#btnDownload").click(function(){var n=GetSearchParamDownload(),t=ValidCheck();t&&HttpPost(`/DemandsletterReport/DemandLetterReportList`,"html",n,function(){})});