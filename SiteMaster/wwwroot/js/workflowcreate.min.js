function GetLevelDetails(){var t=$("#tbl_posts #add #ddlActionType").val(),i=$("#tbl_posts #add #parameterValue option:selected").val(),r=$("#tbl_posts #add #parameterLevel").val(),u=$("#tbl_posts #add #ParameterOrderList").val(),n;$("#tbl_posts #add #parameterName").val()!=""&&$("#tbl_posts #add #parameterValue").val()!=""&&$("#tbl_posts #add #parameterLevel").val()!=""&&$("#tbl_posts #add #dropdownlistDesrtoy").val()!="0"&&$("#tbl_posts #add #ddlActionType").val()!="0"?(n=GetSearchParam(),HttpPostAsync(`/WorkFlowTemplate/GetDetails`,"html",n,function(n){var r,i,t;$("#LoadReportView").append(n);r=0;$(".ParameterConditionalListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterConditionalList["+r+"]");r=r+1});t=0;$(".ParameterNameListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterNameList["+t+"]");t=t+1});t=0;$(".nameClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterLabelNameList["+t+"]");t=t+1});t=0;$(".ParameterValueListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterValueList["+t+"]");$(this).removeAttr("onchange");$(this).attr("onchange","callTypeDropdown("+t+")");t=t+1});t=0;$(".ParameterLevelListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterLevelList["+t+"]");$(this).val(t+1);$(this).removeAttr("disabled","disabled");$(this).attr("disabled","disabled");t=t+1});i=0;$(".ParameterOrderListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterOrderList["+i+"]");$(this).val(i+1);$(this).removeAttr("disabled","disabled");$(this).attr("disabled","disabled");i=i+1});t=0;$(".ParameterActionListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterActionList["+t+"]");t=t+1});t=0;$(".ParameterSkipListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterSkipList["+t+"]");t=t+1});t=1;$(".sn").each(function(){$(this).html("Level "+t);t=t+1});t=1;$(".delete-record").each(function(){$(this).removeAttr("data-id");$(this).attr("data-id",t);t=t+1});t=1;$(".recordDiv").each(function(){$(this).removeAttr("data-id");$(this).attr("id","recordDiv"+t);t=t+1})})):alert("Please fill record before add new record ");$("input[type='hidden'][name='ParameterSkipList[0]']").remove()}function GetSearchParam(){var n=$(".myWebsiteTable").find("table").length;return{size:n}}function GetListData(){var c=$("#ModuleId option:selected").val(),l=$("#Name").val(),a=$("#Description").val(),v=$("#ddlOperationType option:selected").val(),y=$("#Slatime").val(),p=$("#EffectiveDate").val(),w=$("#RevertCode").val(),b=$("#ApprovedCode").val(),k=$("#ForwardCode").val(),e,r,n;e=$("#IsActiveData").is(":checked")?1:0;var f=[],o={},s={};for(r=$(".myWebsiteTable").find("table").length,n=0;n<r;n++){var i=[],d=$("select[name='ParameterConditionalList["+n+"]']").val(),u=$("select[name='ParameterValueList["+n+"]']").val();u=="Role"?i.push($("select[name='ParameterNameList["+n+"]']").val()):i=$("select[name='ParameterNameList["+n+"]']").val();var g=$("input[name='ParameterLevelList["+n+"]']").val(),nt=$("input[name='ParameterOrderList["+n+"]']").val(),h=$("input[name='ParameterSkipList["+n+"]']").val(),t=$("Select[name='ParameterActionList["+n+"]']").val();if(u=="Role"&&(i==null||i=="")||u=="User"&&i.length==0||(n==0&&(t=$.grep(t,function(n){return n!=w})),n<r-1&&(t=$.grep(t,function(n){return n!=b})),n==r-1&&(t=$.grep(t,function(n){return n!=k})),t.length==0))return!1;h=$("input[name='ParameterSkipList["+n+"]']").is(":checked")?!0:!1;o={parameterConditional:d,parameterValue:u,parameterName:i,parameterLevel:g,parameterOrder:nt,parameterSkip:h,parameterAction:t};f.push(o)}return $.isEmptyObject(f)||(s={Id:parseInt(0),moduleId:parseInt(c),slatime:parseInt(y),effectivedate:p,name:l,description:a,usertype:v,isActive:e,template:JSON.stringify(f)}),s}function ModuleIdMessage(){var n=$("#ModuleId option:selected").val();return parseInt(n)<1?"Module is Mandatory":!1}function NameMessage(){var n=$("#Name").val();return n==""?"Process Name is Mandatory":""}function DescriptionMessage(){var n=$("#Description").val();return n==""?"Proccess Description is Mandatory":""}function callTypeDropdown(n){var r=n,t=r,i=$("select[name='ParameterValueList["+r+"]']").val();HttpGet(`/WorkFlowTemplate/GetUserList/?value=${i}`,"json",function(n){for(var u='<option selected="selected" disabled="disabled" value="0">--Select-- <\/option>',r=0;r<n.length;r++)u=u+"<option value="+n[r].id+">"+n[r].name+"<\/option>";$("select[name='ParameterNameList["+t+"]']").val(null).trigger("change");i=="Role"?$("select[name='ParameterNameList["+t+"]']").removeAttr("multiple","multiple"):$("select[name='ParameterNameList["+t+"]']").attr("multiple","");$("select[name='ParameterNameList["+t+"]']").html(u);$("label[name='ParameterLabelNameList["+t+"]']").html(i+" Name");$("select[name='ParameterNameList["+t+"]']").select2({})})}function callSelect2(){$("select").select2({})}$(document).ready(function(){var n=GetSearchParam();HttpPostAsync(`/WorkFlowTemplate/GetDetails`,"html",n,function(n){$("#LoadReportView").append(n)});$("input[type='hidden'][name='ParameterSkipList[0]']").remove()});$(document).delegate("a.add-record","click",function(){GetLevelDetails()});$(document).delegate("a.delete-record","click",function(n){var u,f,r,i,t;return n.preventDefault(),u=confirm("Are you sure You want to delete"),u==!0?(f=jQuery(this).attr("data-id"),$("#recordDiv"+f).remove(),r=0,$(".ParameterConditionalListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterConditionalList["+r+"]");r=r+1}),t=0,$(".ParameterNameListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterNameList["+t+"]");t=t+1}),t=0,$(".ParameterValueListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterValueList["+t+"]");$(this).removeAttr("onchange");$(this).attr("onchange","callTypeDropdown("+t+")");t=t+1}),t=0,$(".nameClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterLabelNameList["+t+"]");t=t+1}),t=0,$(".ParameterLevelListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterLevelList["+t+"]");$(this).val(t+1);$(this).removeAttr("disabled","disabled");$(this).attr("disabled","disabled");t=t+1}),i=0,$(".ParameterOrderListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterOrderList["+i+"]");$(this).val(i+1);$(this).removeAttr("disabled","disabled");$(this).attr("disabled","disabled");i=i+1}),t=0,$(".ParameterActionListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterActionList["+t+"]");t=t+1}),t=0,$(".ParameterSkipListClass").each(function(){$(this).removeAttr("name");$(this).attr("name","ParameterSkipList["+t+"]");t=t+1}),t=1,$(".sn").each(function(){$(this).html("Level "+t);t=t+1}),t=1,$(".delete-record").each(function(){$(this).removeAttr("data-id");$(this).attr("data-id",t);t=t+1}),t=1,$(".recordDiv").each(function(){$(this).removeAttr("data-id");$(this).attr("data-id","recordDiv"+t);t=t+1}),!0):!1});$("#btnCreate").click(function(){var n=!1,c=$("#ModuleId option:selected").val(),i,r,u,f,t,o,s,h;if(parseInt(c)<1?(n=!1,$("#ModuleIdMessage").show()):(n=!0,$("#ModuleIdMessage").hide()),i=$("#Name").val(),i==""?(n=!1,$("#NameMessage").show()):(n=!0,$("#NameMessage").hide()),r=$("#Description").val(),r==""?(n=!1,$("#DescriptionMessage").show()):(n=!0,$("#DescriptionMessage").hide()),u=$("#Slatime").val(),u==""?(n=!1,$("#SlatimeMessage").show()):(n=!0,$("#SlatimeMessage").hide()),f=$("#EffectiveDate").val(),f==""?(n=!1,$("#EffectiveDateMessage").show()):(n=!0,$("#EffectiveDateMessage").hide()),parseInt(c)<1||i==""||r==""||u==""||f=="")return n=!1,WarningMessage("Please Fill all Mandatory Fields");var l=$("#ApprovedCode").val(),a=$("#ForwardCode").val(),e=$(".myWebsiteTable").find("table").length;for(t=0;t<e;t++){if(o=!1,o=$("input[name='ParameterSkipList["+t+"]']").is(":checked")?!0:!1,s=$("Select[name='ParameterActionList["+t+"]']").val(),t<e-1&&jQuery.inArray(a,s)==-1)return InfoMessage("Forward Action is mandatroy at each level apart from last level.");if(t==e-1){if(jQuery.inArray(l,s)==-1)return InfoMessage("Approved action is missing at last level. Kindly include Approved Action at Last level.");if(o==!0)return InfoMessage("Last level cannot be skipped, Please unselect skip at last level")}}n&&(h=GetListData(),h?HttpPostAsync(`/WorkFlowTemplate/Create`,"json",h,function(n){n!=null?n[0]=="false"?WarningMessage(n[1]):(window.location.href=n[0],SuccessMessage(n[1])):WarningMessage("Unable to update records")}):WarningMessage("Please Fill all details Level wise"))});$("#myForm").validate({rules:{ModuleId:{required:!0},Name:{required:!0},Description:{required:!0}},messages:{ModuleId:{required:ModuleIdMessage},Name:{required:NameMessage},Description:{required:DescriptionMessage}},highlight:function(n){$(n).closest(".form-group").addClass("has-error")},unhighlight:function(n){$(n).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(n,t){t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},submitHandler:function(){var n=GetListData();return HttpPostAsync(`/WorkFlowTemplate/Create`,"json",n,function(){window.location.href="/WorkFlowTemplate/Index"}),!0}});